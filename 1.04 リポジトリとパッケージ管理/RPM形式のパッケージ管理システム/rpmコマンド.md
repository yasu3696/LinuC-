# 🏗 RPMとは何か？

-   **RPMパッケージ**は、アプリケーションやライブラリ、設定ファイルを1つにまとめたアーカイブ形式
-   `.rpm` 拡張子を持ち、パッケージのメタデータ（バージョン、依存関係、提供元など）も含まれる
-   rpm はもともと Red Hat が開発し、今では多くのディストリで標準的に使われている


<br>

## 🛠 基本操作オプション

| オプション | 説明 | 使用例 |
|----------------|-----------------|------------|
| `-i` | パッケージを新規インストール | `rpm -ivh nginx.rpm` |
| `-U` | アップグレード（未インストールならインストール）| `rpm-Uvh nginx.rpx` |
| `F`（--freshen） | パッケージがインストールされている場合アップグレード（なければ無視） |  |
| `-e` （erase） | パッケージを削除 | `rpm -e niginx` |

<br>

## 📦 表示関連オプション

| オプション |  説明 | 使用例 |
|------------|--------|----------|
| `-q` (--query) |クエリ（情報取得）| `rpm -q nginx` |
| `-qi` | パッケージの詳細表示 | `rpm -qi nginx` | 
| `-ql` | インストールされたファイル一覧 | `rpm -ql nginx` | 
| `-qf` | 指定ファイルが属するパッケージ表示 | `rpm -qf /usr/bin/nginx` |
| `-qR` |  依存しているパッケージを表示 | `rpm -qR nginx` |
| `-qp` | ローカル `.rpm` の情報確認 |`rpm -qpi somefile.rpm` |

<br>

## 🔍 検証・検査系オプション

| オプション | 説明 | 使用例 |
|--------|-------|-----|
| `-V` または `--verify` | パッケージの整合性チェック | `rpm -V nginx` |
| `--checksig` | `.rpm` に署名があるか検証 | `rpm --checksig nginx.rpm` |
| `--nosignature` | 署名を無視して処理 | `rpm -ivh --nosignature nginx.rpm` |

<br>

## 📦 インストール時の制御オプション

| オプション | 説明 |
|-----------------------|----------------------|
| `-v` | 詳細情報を表示する |
| `-h`（--hash） | インストールやアップデートの進捗状況を「#」（メーター）で管理する |
| `--nodeps` | 依存関係のチェックを無視して強制インストール |
| `--replacepkgs` | すでにあるパッケージを再インストール |
| `--force` | 警告を無視して強行実行（非推奨・慎重に！） |
| `--test` | 実際にはインストールしないで仮テストを実施しする |
| `-a`（--all） | 全て |
| `-p`（--package）| 対象をパッケージファイルにする |

<br>

----------------------

<br>

## 🔧 基本的な `rpm` コマンド

| コマンド | 説明 |
|--------------|----------------|
| `rpm -ivh foo.rpm` | パッケージのインストール（install）|
| `rpm -Uvh foo.rpm` | アップグレード（またはインストール）|
| `rpm -e パッケージ名` | パッケージの削除（erase）|
| `rpm -q パッケージ名` | パッケージの情報を取得（query）|
| `rpm -ql パッケージ名` | パッケージが展開するファイル一覧 |
| `rpm -qi パッケージ名` | 詳細なパッケージ情報を表示 |
| `rpm -qR パッケージ名` | 依存しているパッケージを表示 |
| `rpm -Va` | パッケージ整合性検査（Verify All）|
| `rpm -qa --last ｜ less` | パッケージをインストールした日時と表示 |
📝 `rpm` 単体では**依存解決ができない**ため、通常は `dnf` や `yum` と組み合わせて使います。

<br>

## 🧩 `.rpm` パッケージの構造

RPMは以下のようなセクションを持っています

-   **ヘッダー情報**（名前、バージョン、リリース、アーキテクチャ）
-   **ファイルのアーカイブ**（インストール対象）
-   **スクリプト**（`%pre`, `%post`, `%preun`, `%postun` などの実行指示）



🛠 RPMビルドの基本（簡易版）

Ryutoのように仮想環境や専用ツールを展開する場合、自作RPMも視野に入るはずです

1.  必要なディレクトリ作成：

rpmdev-setuptree

2.  `.spec` ファイルを書く（ビルド指示書）
3.  ソースやファイル配置
4.  ビルド：

rpmbuild -ba myapp.spec

生成物は `~/rpmbuild/RPMS/` に出力されます。
