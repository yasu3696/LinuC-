# 🛠️ `sed` の編集コマンド チートシート

<br>


## ⚙️ `sed` の主なオプション一覧

| オプション | 説明 | 使用例 |
|---|---|---|
| 使用例 | 
| `-e` | 複数の編集コマンドを指定 | `sed -e 's/foo/bar/' -e '/baz/d' file.txt` |
| `-n` | デフォルト出力を抑制し、`p`など明示したときだけ出力 | `sed -n '/error/p' log.txt` |
| `-i` |ファイルを**直接編集（上書き）**  `sed -i 's/old/new/g' file.txt`  🔒 **注意：元に戻せないのでバックアップ推奨** |
| `-i.bak` | 編集前に `.bak` という拡張子でバックアップを作成 | `sed -i.bak 's/foo/bar/g' file.txt` |
| `-f` | 編集スクリプトをファイルから読み込む | `sed -f script.sed file.txt` |


<br>

# コマンド一覧

## 🎯 基本の置換（substitution）

| コマンド | 基本構文 | 説明 |
|--|--|--|
| s | sed `s`/置換前/置換後/`g` ファイル名 | ファイルや標準入力の内容を編集して表示する |


#### -   `s`：substitute（置換）
#### -   `g`：global（行内すべての一致箇所を対象）
#### -   `1,3s/foo/bar/`：1行目～3行目でのみ置換


<br>



## 🧹 削除（delete）


| コマンド | 基本構文 | 説明 |
|--|--|--|
| d | sed /pattern/`d` ファイル名 | 文字列が含まれる行を削除して表示 |


#### -   特定のパターンを含む行を削除
#### -   `1,5d`：1行目～5行目を削除
#### -   `$d`：最終行を削除


## ✅ 正しい構文の比較

| やりたいこと | 正しい書き方 | 意味
|---|---|---|
| `"SED"` を含む行を削除 | `sed '/SED/d' sed.txt` | パターンマッチで削除
| **1行目**を削除 | `sed '1d' sed.txt` | 行番号指定で削除 |
| **1行目で "SED" を含む行だけ削除** | `sed '1{/SED/d}' sed.txt` | 条件付き削除 |


### ✅一致した文字列だけを削除
| 基本構文 | 
|--|
| sed 's/削除したい文字列//g' ファイル名 |
 
<br>

・ `//`：置換後を空にする → 削除と同じ意味
・`g`：行内のすべての一致箇所を対象にする


<br>


## ✂️ 抽出（print / quit）

| コマンド | 基本構文 | 説明 |
|--|--|---|
| p | sed `-n` /pattern/`p` ファイル名 | 行数を指定して表示 |

#### -   `-n`：出力抑制（必要な行だけ出力）
#### -   `/pattern/p`：パターンに一致した行だけ出力
#### -   `5q`：5行目で終了（高速化に便利）


<br>



## 🧬 挿入・追加・置換

| コマンド例 | 意味 |
|---|---|
| `sed '2a 追加する行'` | 2行目の後に挿入（a：append） |
| `sed '3i 挿入する行'` | 3行目の前に挿入（i：insert） |
| `sed '4c 差し替える行'` | 4行目を丸ごと差し替え（c：change）|


<br>



## 🔄 複数コマンドの組み合わせ

### sed -e 's/foo/bar/' -e '3d' file.txt

#### -   `-e`で複数の編集コマンドを並列実行
#### -   `;`や`{}`で連結も可：

### sed '1,3{ s/foo/bar/; d }' file.txt


<br>


## 📌 高度な例（行の入れ替え・条件分岐）

#### -   行を逆順にしたいとき（要工夫）

### tac file.txt | sed '...'

#### -   奇数行・偶数行を分ける：

### sed 'n;d' file.txt # 奇数行だけ出力

<br>

## 1️⃣ `i`（insert)


| 意味 | 例文 | 説明 |  
|--|--|--|
| **行の前に挿入**する | sed `3i`\ これは新しい行です file.txt | `3行目の前`に「これは新しい行です」が追加される。 |



<br>


## 2️⃣ `a`（append）

| 意味 | 例文 | 説明 |  
|--|--|--|
| **行の後に追記（追加）**する。 | sed `2a`\ これは追記された行です file.txt | `2行目の後`に「これは追記された行です」を追加。 |



<br>


## 3️⃣ `$`（ドル記号）

| 意味 | 例文 | 説明 |  
|--|--|--|
| **最終行を表すアドレス**として使う | sed `'$a 文字列'` 最終行の後に追加 file,txt | ' `$d`'最終行を削除  `'$a文字列'` 最終行の後に追加 |



<br>


## 4️⃣ `&`（アンパサンド）

| 意味 | 例文 | 説明 |  
|--|--|--|
| **直前の検索パターン全体の再利用** |sed `'s/hello/&aaa/'` sed.txt |  置換後の文字列に、検索にマッチした文字列を再利用したいときに使う。 |

- s/hello/&aaa/ は、「hello にマッチした部分を helloaaa に置換する」という意味。
- & はマッチした文字列（この場合は hello）を表す。
- つまり、&aaa → helloaaa に展開される。

  

   <br>
    
   <br>
